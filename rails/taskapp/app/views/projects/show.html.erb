<h1><%= @project.title %></h1>
<ul>
<% @project.tasks.each do |task| %>
  <li>
    <%= check_box_tag '', '', task.done, {'data-id' => task.id, 'data-project_id' => task.project_id} %>
    <%= task.title %>
    <%= link_to "delete", project_task_path(task.project.id, task.id), method: :delete, data: {confirm: "sure?"} %>
  </li>
<% end %>
<%= form_for [@project, @project.tasks.build] do |f| %>
  <%= f.text_field :title %>
  <%= f.submit %>
<% end %>
</ul>

<script>
  $(function () {
    $('input[type=checkbox]').on('click', function () {
      $.post('/projects/' + $(this).data('project_id') + '/tasks/' + $(this).data('id') + '/toggle')
    });
  });
</script>
